{% extends "layout.html" %}
{% block content %}
  {% if error == "forbidden" %}
    <div class="section">
      <div class="notice" style="color: var(--danger);">Недостаточно прав для этого действия. Доступен только просмотр.</div>
    </div>
  {% endif %}
  <div class="grid">
    <div class="card">
      <h3>Пользователи</h3>
      <div class="value">{{ users_count }}</div>
    </div>
    <div class="card">
      <h3>Генерации</h3>
      <div class="value">{{ generations_count }}</div>
    </div>
    <div class="card">
      <h3>Заказы</h3>
      <div class="value">{{ orders_count }}</div>
    </div>
    <div class="card">
      <h3>Выручка (Stars)</h3>
      <div class="value">{{ stars_revenue }}</div>
    </div>
    <div class="card">
      <h3>Кредитов выдано</h3>
      <div class="value">{{ credits_issued }}</div>
    </div>
    <div class="card">
      <h3>Кредитов потрачено</h3>
      <div class="value">{{ credits_spent }}</div>
    </div>
  </div>

  <div class="section">
    <h3>Последние заказы</h3>
    <div class="table-shell">
      <div class="table-scroll">
      <table class="admin-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Пользователь</th>
            <th>Stars</th>
            <th>Кредиты</th>
            <th>Статус</th>
            <th>Время</th>
          </tr>
        </thead>
        <tbody>
          {% for o in recent_orders %}
          <tr>
            <td>{{ o.id }}</td>
            <td class="muted">{{ o.user_label }}</td>
            <td>{{ o.stars_amount }}</td>
            <td>{{ o.credits_amount }}</td>
            <td>{{ o.status }}</td>
            <td class="muted">{{ o.created_at_msk }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="6">
              <div class="empty-state">
                <div class="empty-state__title">Нет записей</div>
                <div class="empty-state__subtitle">Попробуйте изменить фильтры или обновить страницу</div>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      </div>
    </div>
  </div>

  <div class="section">
    <h3>Последние генерации</h3>
    <div class="table-shell">
      <div class="table-scroll">
      <table class="admin-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Пользователь</th>
            <th>Модель</th>
            <th>Статус</th>
            <th>Время</th>
          </tr>
        </thead>
        <tbody>
          {% for g in recent_gens %}
          <tr>
            <td>{{ g.id }}</td>
            <td class="muted">{{ g.user_label }}</td>
            <td>{{ g.model }}</td>
            <td>{{ g.status }}</td>
            <td class="muted">{{ g.created_at_msk }}</td>
          </tr>
          {% else %}
          <tr>
            <td colspan="5">
              <div class="empty-state">
                <div class="empty-state__title">Нет записей</div>
                <div class="empty-state__subtitle">Попробуйте изменить фильтры или обновить страницу</div>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      </div>
    </div>
  </div>
{% endblock %}

